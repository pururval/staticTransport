<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <title>Simple markers</title>
      <style>
      /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
      #map {
        height: 100%;
      }
      /* Optional: Makes the sample page fill the window. */
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
    </style>
  </head>
  <body>

    <div id="map"></div>
    <script>
		var googleMap;
    var BusStops = [
      ['1', 43.008204, -78.785880], //ellicot
      ['2', 43.008204, -78.785880],
      ['3', 43.009153, -78.785902],
      ['4', 43.009224, -78.785237],
      ['5', 43.009224, -78.784743],
      ['6', 43.009216, -78.784056],
      ['7', 43.009228, -78.783495],
      ['8', 43.009228, -78.783173],
      ['9', 43.009369, -78.783173],
      ['10', 43.009549, -78.783184],
      ['11', 43.009533, -78.782766],
      ['12', 43.009549, -78.782423],
      ['13', 43.009510, -78.781951],
      ['14', 43.009259, -78.781908],
      ['15', 43.009047, -78.781876],
      ['16', 43.008874, -78.781844],
      ['17', 43.008678, -78.781782],
      ['18', 43.008521, -78.781750],
      ['19', 43.008223, -78.781632],
      ['20', 43.007972, -78.781493],
      ['21', 43.007697, -78.781386],
      ['22', 43.007438, -78.781783],
      ['23', 43.007250, -78.782040],
      ['24', 43.007124, -78.782201],
      ['25', 43.007022, -78.782383],
      ['26', 43.006826, -78.782576],
      ['27', 43.006630, -78.782898],
      ['28', 43.006457, -78.783188],
      ['29', 43.006292, -78.783499],
      ['30', 43.006166, -78.783864],
      ['31', 43.006033, -78.784143],
      ['32', 43.005923, -78.784497],
      ['33', 43.005821, -78.784862],
      ['34', 43.005644, -78.785184],
      ['35', 43.005550, -78.785581],
      ['36', 43.005597, -78.785924],
      ['37', 43.005401, -78.786128],
      ['38', 43.005268, -78.785983],
      ['39', 43.005107, -78.785956],
      ['40', 43.004868, -78.785945],
      ['41', 43.004656, -78.785934],
      ['42', 43.004503, -78.785945],
      ['43', 43.004354, -78.785966],
      ['44', 43.004201, -78.785955],
      ['45', 43.004060, -78.785939],
      ['46', 43.003919, -78.785939],
      ['47', 43.003766, -78.785944],
      ['48', 43.003652, -78.785906],
      ['49', 43.003432, -78.785922],
      ['50', 43.003283, -78.785949],
      ['51', 43.003118, -78.785917],
      ['52', 43.002992, -78.785917],
      ['53', 43.002894, -78.785917],
      ['54', 43.002800, -78.785917],
      ['55', 43.002671, -78.785901],
      ['56', 43.002549, -78.785912],
      ['57', 43.002449, -78.785912],
      ['58', 43.002349, -78.785912],
      ['59', 43.002249, -78.785912],
      ['60', 43.002149, -78.785912],
      ['61', 43.002049, -78.785912],
      ['62', 43.001946, -78.785752], //lee loop
      ['63', 43.002055, -78.785570],
      ['64', 43.002141, -78.785855],
      ['65', 43.002314, -78.785876],
      ['66', 43.002589, -78.785876],
      ['67', 43.002895, -78.785908],
      ['68', 43.003138, -78.785951],
      ['69', 43.003169, -78.786155],
      ['70', 43.003193, -78.786391],
      ['71', 43.003169, -78.786595],
      ['72', 43.003185, -78.786777],
      ['73', 43.003193, -78.786927],
      ['74', 43.003193, -78.787077],
      ['75', 43.003193, -78.787367],
      ['76', 43.003193, -78.787603],
      ['77', 43.003201, -78.787839],
      ['78', 43.003138, -78.788236],
      ['79', 43.003162, -78.788504],
      ['80', 43.003162, -78.788815],
      ['81', 43.003178, -78.789148],
      ['82', 43.003170, -78.789427],
      ['83', 43.003170, -78.789642],
      ['84', 43.003162, -78.789857],
      ['85', 43.003170, -78.790039],
      ['86', 43.003178, -78.790232],
      ['87', 43.003178, -78.790414],
      ['88', 43.003194, -78.790693],
      ['89', 43.003178, -78.791337],
      ['90', 43.003139, -78.791959],
      ['91', 43.003155, -78.792399],
      ['92', 43.003147, -78.792860],
      ['93', 43.003147, -78.793182],
      ['94', 43.003092, -78.793407],
      ['95', 43.002810, -78.793407],
      ['96', 43.002669, -78.793407],
      ['97', 43.002387, -78.793426],
      ['98', 43.002214, -78.793437],
    ['99', 43.002120, -78.793448], //governors
      ['100', 43.002002, -78.793448],
      ['101', 43.001782, -78.793459],
      ['102', 43.001523, -78.793555],
      ['103', 43.001390, -78.793694],
        ['104', 43.001390, -78.793694],
        ['105', 43.001154, -78.793973],
        ['106', 43.000981, -78.794096],
        ['107', 43.000840, -78.794155],
        ['108', 43.000644, -78.794171],
        ['109', 43.000495, -78.794155],
        ['110', 43.000346, -78.794139],
        ['111', 43.000181, -78.794144],
      ['112',   42.999953, -78.794128],
      ['113',   42.999796, -78.794144],
        ['114', 42.999553, -78.794139],
        ['115', 42.999294, -78.794144],
        ['116', 42.999114, -78.794160],
        ['117', 42.998871, -78.794155],
        ['118', 42.998871, -78.794155],
        ['119', 42.998588, -78.794155],
        ['120', 42.998392, -78.794160],
        ['121', 42.998243, -78.794155],
        ['122', 42.998023, -78.794117],
        ['123', 42.998031, -78.793886],
        ['124', 42.998055, -78.793591],
        ['125', 42.998071, -78.793307],
        ['126', 42.998071, -78.793307],
        ['127', 42.998056, -78.792663],
        ['128', 42.998048, -78.792325],
        ['129', 42.998048, -78.791880],
        ['130', 42.998064, -78.791542],
        ['131', 42.998103, -78.791215],
        ['132', 42.998064, -78.790759],
        ['133', 42.998056, -78.790346],
        ['134', 42.998064, -78.789933],
        ['135', 42.998064, -78.789692],
        ['136', 42.998064, -78.789418],
        ['137', 42.998064, -78.789091],
        ['138', 42.998307, -78.789161],
        ['139', 42.998558, -78.789145],
        ['140', 42.998833, -78.789183],
        ['141', 42.999123, -78.789178],
        ['142', 42.999523, -78.789173],
        ['143', 42.999719, -78.789168],
        ['144', 43.000119, -78.788953],
      ['145', 43.000153, -78.789152], //flint
      // ['146', 42.992871, -78.792277], //service road
    ];


		// var busgap =
		// 	["5","7","8","1","6","3"];

		var buses = [
		['b1',"http://maps.google.com/mapfiles/ms/icons/blue-dot.png"]
		,['b2',"http://maps.google.com/mapfiles/ms/icons/red-dot.png"]];

		var busMarker = [];

    var i= 1;

		function initMap() {
			googleMap = new google.maps.Map(document.getElementById('map'), {
				center: {lat: 43.000153, lng: -78.789152},
				zoom: 15
			});
			smos(googleMap);

// // //////
// // Define the symbol, using one of the predefined paths ('CIRCLE')
// // supplied by the Google Maps JavaScript API.
// var circ = {
// path: google.maps.SymbolPath.CIRCLE,
// scale: 8,
// strokeColor: '#393'
// };
//
// // // Create the polyline and add the symbol to it via the 'icons' property.
// var line = new google.maps.Polyline({
// path: [{lat: 43.001946, lng: -78.785752}, {lat: 43.002120, lng: -78.793448}, {lat: 43.000153, lng: -78.789152}],
//
// icons: [{
// icon: circ,
// offset: '100%',
// }],
// map: googleMap
// });
//
// // Use the DOM setInterval() function to change the offset of the symbol at fixed intervals.
// function animateCircle(line) {
//     var count = 0;
//     window.setInterval(function() {
//       count = (count + 1) % 200;
//
//       var icons = line.get('icons');
//       icons[0].offset = (count / 2) + '%';
//       line.set('icons', icons);
//   }, 500);
// }
//
// animateCircle(line);
// //////
		}



		function setLocations(map,BusStops) {
			AddMarker(map,BusStops,"1","31",buses[0][1]);
			AddMarker(map,BusStops,"1","32",buses[1][1]);
		}

		function AddMarker(map,BusStops,hr,min,busIc){
			var now = new Date();
			var millis = new Date(now.getFullYear(), now.getMonth(), now.getDate(), hr, min, now.getSeconds(), now.getMilliseconds()) - now;
			if (millis < 0) {
				millis += 864.00000;
			}
			var myAmot = setTimeout(function(){amot(map,BusStops,busIc)}, millis);
		}

		function amot(map,BusStops,busIc){    //add marker on time
			var marker = new google.maps.Marker({
				position: new google.maps.LatLng(BusStops[0][1],BusStops[0][2]),
				map: map,
				icon: busIc
			});
			busMarker.push(marker);
			// var s1 = setTimeout(function(){moveBusTo1(map,marker)}, 500);
      var s1 = setTimeout(function(){moveBus(map,marker)}, 500);

		}

		// function moveBusTo1( map, marker ) {
		// 	marker.setPosition( new google.maps.LatLng( BusStops[1][1], BusStops[1][2] ) );
		// 	// map.panTo( new google.maps.LatLng( BusStops[1][1], BusStops[1][2] ) );
		// 	var s2 = setTimeout(function(){moveBusTo2(map,marker)}, 500);
		// };
    //
		// function moveBusTo2( map, marker ) {
		// 	marker.setPosition( new google.maps.LatLng( BusStops[2][1], BusStops[2][2] ) );
		// 	// map.panTo( new google.maps.LatLng( BusStops[2][1], BusStops[2][2] ) );
		// 	var s3 = setTimeout(function(){moveBusTo3(map,marker)}, 500);
		// };
    //
		// function moveBusTo3( map, marker ) {
		// 	marker.setPosition( new google.maps.LatLng( BusStops[3][1], BusStops[3][2] ) );
		// 	// map.panTo( new google.maps.LatLng( BusStops[3][1], BusStops[3][2] ) );
		// 	var s4 = setTimeout(function(){moveBusTo4(map,marker)}, 500);
		// };
    //
		// function moveBusTo4( map, marker ) {
		// 	marker.setPosition( new google.maps.LatLng( BusStops[4][1], BusStops[4][2] ) );
		// 	// map.panTo( new google.maps.LatLng( BusStops[4][1], BusStops[4][2] ) );
		// 	var s5 = setTimeout(function(){moveBusTo5(map,marker)}, 500);
		// };
    //
    // function moveBusTo5( map, marker ) {
		// 	marker.setPosition( new google.maps.LatLng( BusStops[0][1], BusStops[0][2] ) );
		// 	// map.panTo( new google.maps.LatLng( BusStops[4][1], BusStops[4][2] ) );
		// 	var s5 = setTimeout(function(){moveBusTo1(map,marker)}, 500);
		// };

    function moveBus(map, marker){
      marker.setPosition( new google.maps.LatLng( BusStops[i][1], BusStops[i][2] ) );
      i+=1;
      if(i>146){
        i=0;
      }
      var s5 = setTimeout(function(){moveBus(map,marker)}, 100);
    }


		function smos(map) {   // set marker on spot
			setLocations(map,BusStops);
			for (var i = 0; i < busMarker.length; i++) {
				busMarker[i].setMap(map);
			}
		}

		function clearLocations() {
			smos(null);
		}

		function showLocations() {
			smos(googleMap);
		}
	</script>
    <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBfzLK-C_jik22yCDp6oOQg4nnbkC2DYA0&callback=initMap">
    </script>
  </body>
</html>
