<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <title>Simple markers</title>
      <style>
      /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
      #map {
        height: 100%;
      }
      /* Optional: Makes the sample page fill the window. */
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
    </style>
  </head>
  <body>

    <div id="map"></div>
<script src="co-ods.js"></script>
    <script>
		var googleMap;




		// var busgap =
		// 	["5","7","8","1","6","3"];

		var buses = [
		['b1',"http://maps.google.com/mapfiles/ms/icons/blue-dot.png"]
		,['b2',"http://maps.google.com/mapfiles/ms/icons/red-dot.png"]];

		var busMarker = [];

    var i= 1;

		function initMap() {
			googleMap = new google.maps.Map(document.getElementById('map'), {
				center: {lat: 43.000153, lng: -78.789152},
				zoom: 15
			});
			smos(googleMap);

// // //////
// // Define the symbol, using one of the predefined paths ('CIRCLE')
// // supplied by the Google Maps JavaScript API.
// var circ = {
// path: google.maps.SymbolPath.CIRCLE,
// scale: 8,
// strokeColor: '#393'
// };
//
// // // Create the polyline and add the symbol to it via the 'icons' property.
// var line = new google.maps.Polyline({
// path: [{lat: 43.001946, lng: -78.785752}, {lat: 43.002120, lng: -78.793448}, {lat: 43.000153, lng: -78.789152}],
//
// icons: [{
// icon: circ,
// offset: '100%',
// }],
// map: googleMap
// });
//
// // Use the DOM setInterval() function to change the offset of the symbol at fixed intervals.
// function animateCircle(line) {
//     var count = 0;
//     window.setInterval(function() {
//       count = (count + 1) % 200;
//
//       var icons = line.get('icons');
//       icons[0].offset = (count / 2) + '%';
//       line.set('icons', icons);
//   }, 500);
// }
//
// animateCircle(line);
// //////
		}



		function setLocations(map,BusStops) {
			AddMarker(map,BusStops,"1","31",buses[0][1]);
			AddMarker(map,BusStops,"1","32",buses[1][1]);
		}

		function AddMarker(map,BusStops,hr,min,busIc){
			var now = new Date();
			var millis = new Date(now.getFullYear(), now.getMonth(), now.getDate(), hr, min, now.getSeconds(), now.getMilliseconds()) - now;
			if (millis < 0) {
				millis += 864.00000;
			}
			var myAmot = setTimeout(function(){amot(map,BusStops,busIc)}, millis);
		}

		function amot(map,BusStops,busIc){    //add marker on time
			var marker = new google.maps.Marker({
				position: new google.maps.LatLng(BusStops[0][1],BusStops[0][2]),
				map: map,
				icon: busIc
			});
			busMarker.push(marker);
			// var s1 = setTimeout(function(){moveBusTo1(map,marker)}, 500);
      var s1 = setTimeout(function(){moveBus(map,marker)}, 500);

		}

		// function moveBusTo1( map, marker ) {
		// 	marker.setPosition( new google.maps.LatLng( BusStops[1][1], BusStops[1][2] ) );
		// 	// map.panTo( new google.maps.LatLng( BusStops[1][1], BusStops[1][2] ) );
		// 	var s2 = setTimeout(function(){moveBusTo2(map,marker)}, 500);
		// };
    //
		// function moveBusTo2( map, marker ) {
		// 	marker.setPosition( new google.maps.LatLng( BusStops[2][1], BusStops[2][2] ) );
		// 	// map.panTo( new google.maps.LatLng( BusStops[2][1], BusStops[2][2] ) );
		// 	var s3 = setTimeout(function(){moveBusTo3(map,marker)}, 500);
		// };
    //
		// function moveBusTo3( map, marker ) {
		// 	marker.setPosition( new google.maps.LatLng( BusStops[3][1], BusStops[3][2] ) );
		// 	// map.panTo( new google.maps.LatLng( BusStops[3][1], BusStops[3][2] ) );
		// 	var s4 = setTimeout(function(){moveBusTo4(map,marker)}, 500);
		// };
    //
		// function moveBusTo4( map, marker ) {
		// 	marker.setPosition( new google.maps.LatLng( BusStops[4][1], BusStops[4][2] ) );
		// 	// map.panTo( new google.maps.LatLng( BusStops[4][1], BusStops[4][2] ) );
		// 	var s5 = setTimeout(function(){moveBusTo5(map,marker)}, 500);
		// };
    //
    // function moveBusTo5( map, marker ) {
		// 	marker.setPosition( new google.maps.LatLng( BusStops[0][1], BusStops[0][2] ) );
		// 	// map.panTo( new google.maps.LatLng( BusStops[4][1], BusStops[4][2] ) );
		// 	var s5 = setTimeout(function(){moveBusTo1(map,marker)}, 500);
		// };

    function moveBus(map, marker){
      marker.setPosition( new google.maps.LatLng( BusStops[i][1], BusStops[i][2] ) );
      i+=1;
      if(i>195){
        i=0;
      }
      var s5 = setTimeout(function(){moveBus(map,marker)}, 100);
    }


		function smos(map) {   // set marker on spot
			setLocations(map,BusStops);
			for (var i = 0; i < busMarker.length; i++) {
				busMarker[i].setMap(map);
			}
		}

		function clearLocations() {
			smos(null);
		}

		function showLocations() {
			smos(googleMap);
		}
	</script>
    <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBfzLK-C_jik22yCDp6oOQg4nnbkC2DYA0&callback=initMap">
    </script>
  </body>
</html>
